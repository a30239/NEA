# 2007-2021年的观测数据
H_detect = HList = [11.16, 15.5, 13.4, 9.45, 17.7, 14.8, 15.6, 13.2, 14.23, 16.25, 15.54, 14.85, 16.84, 12.4, 14.93, 13.9, 15.75, 13.92, 15.2, 16.0, 16.56, 16.8, 17.3, 15.25, 13.87, 14.5, 15.21, 16.2, 15.38, 14.1, 14.84, 14.6, 16.5, 15.2, 15.8, 15.9, 19.03, 16.75, 12.9, 15.82, 16.5, 14.7, 15.3, 17.3, 17.9, 15.99, 14.7, 15.3, 14.4, 14.6, 15.9, 15.9, 16.0, 17.1, 15.6, 15.6, 20.7, 16.3, 18.2, 18.0, 12.5, 16.4, 14.7, 14.0, 17.8, 14.7, 15.1, 13.8, 17.3, 17.0, 14.2, 17.1, 15.4, 16.2, 16.7, 15.6, 14.7, 17.1, 18.8, 16.0, 14.9, 15.8, 17.2, 17.5, 18.7, 17.8, 14.9, 14.7, 15.9, 15.1, 18.5, 13.9, 15.8, 16.4, 16.9, 18.3, 16.8, 15.1, 17.0, 18.8, 16.7, 17.2, 14.7, 18.0, 17.1, 18.6, 17.4, 15.1, 15.2, 15.1, 17.0, 18.7, 17.9, 17.1, 16.4, 15.7, 16.3, 15.3, 16.9, 17.9, 17.9, 16.4, 14.9, 17.4, 16.1, 17.0, 16.9, 15.4, 17.3, 19.3, 17.7, 17.0, 15.2, 18.2, 16.0, 16.3, 15.2, 18.3, 15.8, 15.8, 15.8, 16.4, 17.6, 18.6, 17.3, 18.4, 16.2, 15.6, 17.8, 14.3, 16.3, 16.9, 16.6, 17.1, 17.0, 15.6, 15.8, 15.9, 15.9, 16.7, 18.2, 17.6, 15.2, 16.4, 13.9, 14.3, 16.0, 17.4, 17.9, 17.7, 16.8, 16.0, 16.1, 16.6, 16.4, 14.7, 16.3, 17.3, 19.2, 16.6, 13.6, 16.8, 18.1, 15.4, 18.1, 17.7, 17.1, 14.7, 16.4, 17.2, 17.3, 17.2, 15.9, 15.8, 17.9, 16.0, 16.7, 16.9, 19.3, 19.2, 16.2, 14.9, 17.4, 16.2, 18.4, 16.5, 15.7, 17.7, 15.5, 17.7, 16.5, 17.7, 17.8, 20.0, 17.5, 14.8, 15.8, 16.7, 15.2, 17.2, 16.7, 14.7, 17.4, 17.1, 18.0, 16.5, 15.0, 16.0, 18.2, 19.5, 19.1, 20.8, 18.4, 18.0, 19.2, 18.4, 16.0, 14.5, 16.9, 16.5, 18.9, 16.6, 17.0, 18.2, 18.1, 15.5, 16.5, 18.5, 16.9, 19.8, 14.2, 15.9, 17.9, 16.4, 17.5, 17.1, 18.3, 18.6, 16.1, 14.7, 17.0, 15.9, 19.2, 15.3, 15.5, 16.5, 18.0, 18.1, 17.1, 20.2, 16.0, 16.4, 16.9, 17.6, 17.4, 18.7, 18.1, 16.4, 16.0, 19.4, 17.6, 15.6, 17.0, 17.6, 20.2, 15.6, 14.9, 17.0, 16.4, 15.3, 18.3, 17.8, 17.6, 16.4, 17.0, 16.2, 18.0, 14.7, 18.7, 16.4, 18.3, 17.9, 16.0, 16.4, 17.8, 16.2, 16.6, 16.3, 15.8, 16.2, 15.9, 17.9, 15.2, 15.5, 15.8, 17.4, 19.9, 17.7, 16.8, 19.0, 18.5, 18.4, 18.9, 18.8, 17.7, 15.7, 17.3, 16.2, 16.6, 16.5, 18.9, 16.2, 16.4, 18.2, 18.1, 18.0, 17.9, 14.6, 18.3, 16.9, 15.1, 18.5, 16.6, 17.2, 16.0, 14.6, 16.0, 17.2, 20.3, 14.9, 16.8, 17.9, 19.1, 18.0, 16.0, 17.0, 20.2, 18.9, 19.2, 15.9, 18.7, 18.4, 19.1, 18.0, 16.7, 16.6, 18.4, 18.3, 18.2, 16.7, 18.9, 17.4, 18.8, 17.7, 17.3, 20.0, 18.3, 17.9, 18.9, 19.1, 16.8, 16.2, 17.7, 17.7, 16.2, 18.2, 18.2, 16.2, 18.1, 17.1, 16.1, 16.0, 16.9, 17.8, 18.6, 15.9, 16.3, 18.3, 16.0, 16.3, 15.3, 16.1, 16.5, 16.6, 15.5, 18.8, 17.3, 16.4, 19.1, 19.0, 19.8, 19.8, 17.0, 16.3, 20.1, 16.7, 19.2, 19.1, 18.8, 18.4, 18.6, 18.1, 16.1, 17.6, 16.7, 17.6, 17.6, 19.6, 19.3, 17.5, 16.7, 17.1, 16.9, 18.3, 16.7, 16.8, 17.9, 16.5, 17.3, 17.4, 16.6, 17.5, 17.9, 17.8, 19.3, 17.6, 18.1, 16.7, 16.5, 18.1, 18.8, 18.4, 18.6, 18.4, 18.4, 17.8, 17.5, 17.3, 17.1, 16.3, 18.3, 16.6, 16.1, 18.1, 17.3, 17.0, 17.6, 17.0, 16.5, 17.1, 18.0, 17.9, 16.4, 18.0, 17.5, 17.5, 19.4, 18.2, 16.5, 16.6, 18.9, 20.5, 17.3, 19.9, 17.0, 19.3, 18.2, 15.1, 19.1, 17.2, 20.2, 19.2, 18.3, 19.1, 15.7, 18.6, 16.5, 19.2, 17.6, 18.0, 19.1, 15.8, 17.9, 19.2, 17.5, 16.3, 18.5, 16.5, 18.5, 20.1, 18.8, 18.9, 17.3, 18.9, 19.2, 17.0, 18.0, 16.3, 17.3, 16.4, 16.6, 18.4, 17.1, 19.0, 17.6, 19.4, 16.9, 16.5, 18.0, 17.2, 16.9, 18.1, 18.6, 18.3, 17.8, 17.6, 18.1, 18.3, 19.6, 18.3, 17.5, 17.1, 18.3, 20.3, 18.3, 19.7, 17.5, 17.5, 17.4, 16.4, 17.9, 17.8, 18.2, 16.9, 18.0, 17.3, 19.2, 17.4, 16.3, 18.9, 15.6, 17.7, 19.0, 17.5, 16.7, 17.2, 18.1, 18.4, 18.3, 17.3, 16.3, 17.7, 20.4, 17.7, 16.9, 17.2, 19.8, 18.1, 18.6, 17.6, 18.0, 18.6, 19.4, 18.4, 18.7, 18.2, 18.2, 17.1, 20.4, 17.1, 16.1, 16.6, 18.8, 16.7, 17.7, 19.7, 15.3, 18.6, 18.5, 19.4, 20.6, 17.5, 19.6, 18.7, 17.0, 18.1, 16.3, 16.9, 18.5, 18.2, 19.0, 17.8, 18.2, 17.5, 21.7, 18.9, 20.1, 19.5, 18.4, 20.0, 19.3, 17.0, 19.1, 17.7, 16.5, 17.1, 18.5, 18.3, 17.2, 21.3, 17.4, 18.5, 17.9, 18.3, 17.4, 16.5, 17.2, 17.0, 18.1, 15.7, 17.4, 18.1, 17.3, 15.5, 17.4, 18.5, 19.7, 16.1, 16.5, 16.8, 17.7, 19.3, 18.2, 16.2, 18.0, 17.8, 16.8, 17.1, 18.1, 20.2, 19.3, 21.0, 16.6, 17.1, 17.0, 18.0, 18.6, 17.9, 18.6, 18.2, 18.7, 21.2, 19.0, 18.9, 19.7, 18.1, 18.2, 18.9, 18.3, 17.6, 17.7, 18.5, 19.0, 18.0, 19.0, 18.7, 18.7, 18.6, 19.4, 17.1, 18.0, 17.7, 17.7, 18.7, 16.8, 18.8, 19.3, 21.8, 15.3, 17.5, 20.7, 17.9, 18.3, 18.1, 17.5, 17.9, 18.0, 19.1, 18.1, 19.5, 18.4, 17.1, 16.8, 19.6, 19.7, 16.7, 18.6, 18.2, 19.0, 18.0, 16.2, 15.6, 18.5, 17.9, 18.9, 20.7, 18.9, 17.7, 17.8, 19.8, 19.7, 18.5, 19.3, 20.9, 17.5, 18.7, 19.8, 17.1, 17.2, 16.9, 18.1, 19.6, 17.9, 18.4, 18.0, 22.9, 16.3, 17.4, 19.7, 17.8, 19.4, 16.6, 20.2, 17.9, 19.6, 15.5, 20.0, 20.7, 18.8, 16.8, 18.2, 20.3, 18.7, 20.8, 18.6, 16.2, 19.5, 17.7, 18.0, 17.3, 17.3, 18.3, 18.6, 18.6, 22.0, 17.9, 19.9, 20.8, 18.7, 18.8, 19.7, 19.5, 18.1, 20.7, 16.3, 19.3, 16.9, 17.3, 17.5, 19.1, 19.5, 20.1, 19.5, 19.8, 18.8, 17.7, 20.3, 19.2, 18.0, 19.1, 19.5, 21.0, 18.8, 18.8, 17.7, 19.4, 17.8, 18.6, 19.6, 19.4, 18.8, 16.9, 17.3, 17.4, 18.4, 17.1, 16.8, 20.0, 21.5, 16.9, 19.1, 18.4, 19.4, 19.9, 19.6, 19.4, 18.1, 17.4, 17.6, 20.1, 20.6, 19.6, 18.7, 19.7, 18.1, 18.3, 17.8, 18.4, 20.2, 19.4, 18.3, 15.8, 16.6, 16.0, 20.5, 20.0, 18.7, 19.5, 18.0, 19.4, 20.4, 18.1, 20.5, 19.1, 19.1, 17.5, 19.8, 19.7, 18.8, 20.7, 20.0, 18.8, 17.0, 19.3, 15.3, 18.0, 20.3, 17.0, 18.2, 19.1, 18.7, 18.2, 18.1, 18.4, 21.5, 18.5, 18.1, 17.8, 19.3, 18.7, 20.3, 18.8, 19.4, 19.7, 19.0, 16.1, 17.4, 20.0, 15.7, 18.0, 19.0, 20.8, 19.3, 18.0, 18.9, 18.4, 19.5, 20.3, 19.4, 19.2, 17.1, 18.5, 17.7, 20.1, 18.7, 17.5, 19.4, 18.2, 16.7, 20.0, 19.7, 19.6, 18.0, 19.6, 19.6, 20.0, 19.2, 17.3, 16.3, 18.0, 19.4, 18.2, 19.9, 16.6, 19.8, 18.6, 17.7, 19.5, 18.3, 17.9, 19.5, 19.7, 20.7, 19.7, 18.0, 19.8, 19.8, 20.0, 16.8, 18.4, 20.0, 19.4, 19.5, 19.3, 18.0, 19.9, 19.6, 19.0, 18.5, 21.0, 17.7, 19.5, 17.3, 18.9, 19.9, 18.8, 20.5, 19.5, 20.0, 19.2, 19.3, 18.1, 20.9, 18.4, 21.5, 19.5, 17.6, 18.0, 19.4, 17.4, 19.6, 19.2, 19.4, 19.3, 19.5, 18.6, 18.3, 18.2, 21.0, 20.2, 20.7, 19.7, 19.6, 20.3, 19.4, 18.0, 19.2, 19.9, 18.8, 19.7, 17.0, 21.5, 20.4, 18.3, 18.1, 19.4, 18.8, 18.4, 17.5, 20.1, 20.4, 21.1, 18.0, 17.3, 21.2, 17.3, 18.0, 18.5, 17.8, 18.8, 18.3, 19.9, 17.7, 20.3, 18.3, 20.2, 19.0, 17.9, 18.5, 17.5, 18.6, 20.0, 23.3, 18.6, 17.5, 21.0, 18.4, 17.1, 18.6, 18.3, 19.4, 16.6, 18.8, 21.7, 20.0, 19.4, 21.2, 17.8, 19.1, 18.0, 20.5, 19.3, 20.1, 20.4, 21.7, 19.1, 20.9, 20.4, 19.1, 21.1, 18.2, 19.2, 18.9, 20.0, 21.5, 18.8, 21.7, 19.4, 17.5, 19.4, 20.9, 18.9, 17.1, 16.0, 19.2, 19.5, 19.2, 18.8, 19.3, 17.2, 16.7, 20.8, 17.7, 17.5, 20.1, 20.6, 19.9, 17.6, 19.5, 18.0, 19.7, 17.9, 19.5, 21.5, 19.5, 21.1, 20.4, 20.1, 19.2, 20.2, 19.6, 20.1, 17.1, 19.3, 19.3, 16.5, 20.6, 19.3, 19.6, 20.0, 19.7, 21.8, 20.6, 19.0, 18.4, 20.5, 18.5, 18.6, 19.8, 16.6, 20.8, 19.9, 20.6, 19.6, 19.1, 19.7, 19.1, 17.8, 18.7, 18.8, 18.2, 18.6, 17.5, 17.4, 17.7, 18.4, 20.0, 19.2, 21.0, 17.9, 21.3, 20.4, 18.9, 18.3, 18.1, 18.3, 18.1, 18.1, 18.8, 18.5, 17.1, 18.7, 16.9, 17.8, 19.2, 19.5, 18.2, 18.9, 18.3, 19.8, 19.3, 19.9, 20.1, 17.7, 19.4, 18.5, 17.9, 18.9]
#[11.16, 17.7, 14.8, 13.2, 14.23, 14.85, 16.84, 12.4, 13.9, 15.25, 13.87, 14.5, 14.1, 14.84, 14.6, 15.2, 14.7, 15.3, 14.6, 15.9, 17.1, 15.6, 15.6, 20.7, 18.2, 14.7, 14.0, 13.8, 17.1, 15.4, 16.7, 14.7, 14.9, 17.8, 14.9, 14.7, 18.5, 18.3, 16.8, 14.7, 18.6, 18.7, 17.1, 16.4, 16.3, 15.3, 17.9, 17.0, 15.2, 16.0, 15.2, 15.8, 17.3, 15.6, 16.9, 17.0, 15.6, 15.8, 15.9, 18.2, 16.1, 16.6, 16.6, 15.4, 18.1, 17.7, 14.7, 16.0, 16.7, 16.2, 14.9, 15.7, 15.5, 15.8, 17.1, 16.5, 18.2, 19.1, 20.8, 18.0, 19.2, 16.0, 14.5, 16.9, 15.5, 18.5, 14.2, 15.9, 17.9, 16.4, 17.5, 18.3, 16.1, 17.0, 15.3, 18.0, 16.9, 17.6, 16.4, 17.0, 20.2, 14.9, 15.3, 17.8, 14.7, 17.9, 16.0, 15.8, 16.2, 15.9, 15.5, 17.4, 16.8, 15.7, 17.3, 16.2, 18.9, 18.1, 18.0, 14.6, 16.9, 18.5, 14.6, 20.3, 14.9, 16.0, 19.2, 18.7, 18.0, 18.2, 16.7, 17.4, 18.8, 17.3, 18.3, 16.2, 16.2, 16.1, 16.9, 18.6, 16.6, 15.5, 16.4, 19.0, 18.8, 17.6, 19.6, 16.7, 16.5, 16.6, 17.6, 18.1, 17.8, 17.3, 16.1, 17.6, 16.5, 18.0, 17.9, 18.0, 17.5, 19.3, 19.1, 18.5, 16.5, 18.8, 18.9, 18.0, 17.3, 16.5, 18.3, 17.1, 18.3, 16.4, 18.0, 17.7, 16.7, 17.2, 17.3, 17.7, 18.1, 16.6, 19.6, 16.3, 16.9, 19.0, 18.4, 18.5, 17.9, 18.3, 17.4, 15.7, 16.8, 18.0, 17.7, 18.7, 17.7, 17.7, 21.8, 17.9, 18.3, 18.0, 18.6, 18.0, 16.2, 18.5, 18.7, 22.9, 19.5, 17.3, 18.6, 19.9, 18.8, 19.3, 20.3, 19.1, 19.5, 21.0, 18.6, 18.4, 20.1, 19.6, 18.4, 20.5, 19.4, 20.5, 19.8, 18.8, 17.0, 15.3, 17.0, 21.5, 19.0, 16.1, 17.4, 20.3, 20.1, 19.6, 16.3, 19.5, 18.0, 18.4, 19.4, 19.5, 20.5, 20.9, 18.0, 20.7, 18.0, 18.3, 17.3, 18.0, 17.5, 17.1, 21.7, 17.8, 21.7, 21.1, 17.5, 20.9, 19.5, 19.2, 18.8, 21.5, 21.1, 16.6, 19.9, 19.1, 19.1, 17.8, 18.2, 18.1, 18.1, 18.7, 18.2, 17.9]

# 一年的模拟数据
D_simulation = [0.01266998549072098, 0.014182796449252737, 0.11532124262569558, 0.034581931929884374, 0.01958128863891413, 0.12271358911682535, 0.014068109006784887, 0.2919169811551711, 0.019654321918919592, 0.01881911292021164, 0.03211279136505847, 0.052632111749133605, 0.20958353167154714, 0.08991099309109826, 0.0972480822730076, 0.026198621595618428, 0.013316082481568061, 0.06030102614770397, 0.08090136028767472, 0.01740290542527561, 0.06503087942596797, 0.017180827235450908, 0.15165242871571885, 0.5470861470558963, 0.017311651924624177, 0.015399583605874297, 0.0913899370502672, 0.012735459508600935, 0.015681159731351504, 0.01905701751636664, 0.01926868601929188, 0.017087491401347844, 0.01112661971085187, 0.212807436544874, 0.04078603698156334, 0.010852697177789809, 0.014067433593227978, 0.08094225215552538, 0.030234190839708155, 0.03913402294290348, 0.014038170196790828, 0.023637296521851252, 0.02424876166198322, 0.2608745281889616, 0.1402025046648677, 0.06016508051339248, 0.09152234746457152, 0.01889583761168969, 0.011423163858450087, 0.013314182426808065, 0.023314192687649442, 0.015722792343839175, 0.0442987255693618, 0.011324569149264248, 0.018133803574808174, 0.1557907438197636, 0.018574261721011447, 0.015506869961011204, 0.03750869444265163, 0.04519114817258, 0.012653050674667666, 0.015219488766233982, 0.021650185495559995, 0.011939961862020454, 0.019168640139352325, 0.19126243056147743, 0.021532518112250047, 0.013939299417599194, 0.0358629188853126, 0.08548116922560997, 0.024344721941946246, 0.12728929226304528, 0.28810209666187586, 0.012229377843964096, 0.06757305616034902, 0.0189246139418602, 0.017867741942076024, 0.012982664627639562, 0.01917214357767313, 0.010582546738061714, 0.011661143608230643, 0.011045687268340494, 0.011466195354635719, 0.01188014593835766, 0.02876854486908754, 0.01774660895957017, 0.021233232109824522, 0.25606026590549325, 0.06800804467676817, 0.014849982718524004, 0.09158019690205547, 0.11920596175360348, 0.027161979122163005, 0.023003134943215743, 0.030072386838174495, 0.013773088834173722, 0.051674957705510755, 0.02545407087398659, 0.0308918359801614, 0.011369946995470481, 0.07576494719100776, 0.013457746116627128, 0.02019170300964641, 0.013548583914804659, 0.194904557705537, 0.02416402910680053, 0.01373974331456606, 0.11200333869650003, 0.03480713535462002, 0.10354496791018628, 0.016061358937226516, 0.03802291990368387, 0.27509909685221484, 0.011226293343348378, 0.03163642165149836, 0.014683869606275813, 0.029666374183511257, 0.026630220175457065, 0.08330358275067891, 0.018129536175008346, 0.02540320977468344, 0.16675975627149203, 0.04812281393284447, 0.11316491445310234, 0.02591804707714627, 0.05759087821118793, 0.010175696951463075, 0.06445394609842932, 0.05451951744882187, 0.22757384696007665, 0.01015975286406608, 0.09991245860144621, 0.011057007341871898, 0.16116972206660107, 0.014279086458955639, 0.06794085356985498, 0.648194516833888, 0.02146676394769864, 0.10764815481030368, 0.06760799229041485, 0.011768807435138083, 0.08363263390996264, 0.05914301056804222, 0.0172879471102155, 0.023844301892889486, 0.011436079069416759, 0.028527657849670627, 0.010498428198951673, 0.13552841329957954, 0.011654905038555704, 0.018584655410912174, 0.013505321515225988, 0.010234505949150286, 0.11101596227929082, 0.07640602648032858, 0.03892918662131856, 0.1772118503000922, 0.025618698258589527, 0.029432283243496924, 0.0876624505972655, 0.03900789441437821, 0.01510435619584661, 0.019217222225512875, 0.4150026659635904, 0.010936423833533443, 0.0153303661440447, 0.09948585183156555, 0.015562740646097379, 0.0458303604313152, 0.011600077616321728, 0.08085715229056024, 0.0326957897410667, 0.010856048104446885, 0.23326733258535437, 0.03314428467124514, 0.06371905093715531, 0.10706500427088074, 0.01640080298012102, 0.022417160979394706, 0.22158447200374307, 0.23238676531020955, 0.08061239176353002, 0.06544878174657798, 0.04349036817533344, 0.13099809696800596, 0.016207338757131803, 0.020637476007037504, 0.06737207894330986, 0.17961774661753516, 0.019231499543227087, 0.029565743192763547, 0.012449769912737075, 0.03166801208333802, 0.010516580870676969, 0.011608698666236471, 0.051674037584947846, 0.01168526041722333, 0.0459945565002659, 0.02280554289517176, 0.02029620598469199, 0.016767794109063497, 0.020294830209046582, 0.041446770028402365, 0.010362624631953001, 0.036240484575418064, 0.010172497945159887, 0.010196137318938831, 0.010282754052440427, 0.06424331923605296, 0.09534112881946172, 0.02476755528035941, 0.24079735362314028, 2.425690282052066, 0.0971736831348439, 0.020364149448828427, 0.056094401253382956, 0.05995361214294195, 0.024602963681286807, 0.0638557016566775, 0.01758699680629344, 0.020071766576790585, 0.018147319425597018, 0.09170171140950985, 0.12594182142596594, 0.029714525322836423, 0.010903832115020459, 0.012824850953639519, 0.015448290434733801, 0.02249722351768539, 0.08927764063473387, 0.019460318363494582, 0.18221925936426595, 0.0434003001253867, 0.1808213426503011, 0.06089182092863453, 0.02723368265329429, 0.25596287775217036, 0.06375127047207042, 0.03034529294149618, 0.171402862081893, 0.011713206212297437, 0.1825019951491155, 0.019005557000387703, 0.024186466203298406, 0.020436802030049574, 0.024292572465382325, 0.01074237982227212, 0.03677021752838869, 0.026303910231434118, 0.04302137530832016, 0.01675491877314224, 0.019584643019846446, 0.15988837278660215, 0.05229318236958975, 0.012122602360314023, 0.11643410760050998, 0.11096427307542271, 0.022144649574141615, 0.011021744418889869, 0.08056274578368078, 0.04343832354415625, 0.01166866415170131, 0.033984428888949134, 0.012242773258128727, 0.02857898915817118, 0.013183663534773772, 0.017352490317279094, 0.09214761197529316, 0.08462907824795438, 0.010423799255981064, 0.03782710424188335, 0.021221679373119855, 0.013656914610222151, 0.02072710192974693, 0.014374877766186052, 0.014035300777856986, 0.024373301342547667, 0.04083226671391727, 0.06394760141720067, 0.01944874031148469, 0.023897642317208787, 0.02700093836133638, 0.24348707733491856, 0.11686290156769437, 0.05789683364446051, 0.06923266424059467, 0.02739967261910726, 0.015090156900618266, 0.05784598227122388, 0.4183200424686966, 0.013665727808608395, 0.01892523943251861, 0.01048827866971031, 0.08921202802140295, 0.01061775765799286, 0.013777904741636307, 0.018868574969134532, 0.13992601484450917, 0.07909851938516063, 0.01640950430578307, 0.018615855553488037, 0.11971589149595442, 0.5313003141558643, 0.1231028249830241, 0.12195253900321543, 0.24336391198216267, 0.0856609486503142, 0.1375929079081213, 0.032104642668342835, 0.012627888467268917, 0.2661057308464011, 0.0352095648618165, 0.0836724786059122, 0.020720347822877398, 0.037581415280967395, 0.015399449589400446, 0.01614054139060966, 0.015812653458082734, 0.05691193991806569, 0.03655898006866026, 0.023545750402716014, 0.3389456907389202, 0.03384034571238444, 0.016812099289941394, 0.015884269932901665, 0.05148486448549468, 0.054799869406599595, 0.023252188590629976, 0.05527611566781155, 0.029286616472779463, 0.03616686285132112, 0.011937965086867576, 0.12124977011977514, 0.047111458268726314, 0.011851524167700207, 0.01807478668934466, 0.020568725167635093, 0.010672698737228706, 0.01574725834070691, 0.052058649392168706, 0.01940589083872269, 0.04250218606061744, 0.012942180773321038, 0.23926528420525664, 0.017790420984507106, 0.02896981697304715, 0.010825902176654653, 0.061545109071917715, 0.013984527312832309, 0.04515500685428179, 0.056375986408146894, 0.012559916254337894, 0.03978347867088424, 0.02362984036913306, 0.010449982327649647, 0.040659897512882986, 0.010338318336934882, 0.02321671135770117, 0.16540885240440523, 0.03005019760047187, 0.011393720255607677, 0.011142361215909466, 0.016549720821239608, 0.021889827335742087, 0.0513825748269913, 0.030122230651310145, 0.013638209280579237, 0.018262436224114657, 0.021462593536298435, 0.05066280209468726, 0.531866000725687, 0.04563953341918573, 0.013760181490362811, 0.1532318567899466, 0.015041391957808707, 0.05926146760868961, 0.10927824568328913, 0.020132793409725805, 0.09221871091442783, 0.011765621266500385, 0.023967970240507716, 0.10180103174803104, 0.0148511022828459, 0.01587741817648978, 0.15630178941799358, 0.012863551821063995, 0.018191046733969506, 0.01669378476165857, 0.461704101805703, 0.03337994615523351, 0.5511348163568971, 4.128130821688681, 0.02540485284184266, 0.02816426092723399, 0.519537042845993, 0.11835933575886513, 0.06047670115882717, 0.09908647586509589, 0.01019566871573973, 0.07429241329431882, 0.15145463219325453, 0.042301543874605864, 0.08549084728601872, 0.08769090795566288, 0.15566235378894133, 0.02514603336167018, 0.029014071241251282, 0.05759490834490688, 0.09156583785412223, 0.01775951636484185, 0.04297281976011394, 0.05184419058044111, 0.06782784200070809, 0.024528610611351257, 0.07035620852336438, 0.018726127501969933]
# 一次的模拟数据
#D_simulation = [0.017159467113721006, 0.0913899370502672, 0.2608745281889616, 0.1402025046648677, 0.024173301889596866, 0.024344721941946246, 0.28810209666187586, 0.026630220175457065, 0.08330358275067891, 0.5701061321752714, 0.09991245860144621, 0.10764815481030368, 0.89880786514177, 0.029432283243496924, 0.10706500427088074, 0.23238676531020955, 0.08061239176353002, 0.23662817188665544, 0.016767794109063497, 0.7296976852875275, 2.425690282052066, 0.02497074602545296, 0.171402862081893, 0.1825019951491155, 0.41510110473985573, 0.5637931463161691, 0.02700093836133638, 0.11686290156769437, 0.18760163331366672, 0.42184870517008105, 0.42136327415325264, 1.5300849812415367, 0.12562365465973377, 0.7583331465121006, 0.05066280209468726, 0.531866000725687, 0.15830036704969525, 0.461704101805703, 4.128130821688681]

import math
def H2D(H):
    D = []
    # pv 反照率 取0.14
    pv = 0.14
    for i in H:
        D.append(math.pow(10, 3.1236 - 0.2 * i - 0.5 * math.log10(pv)))
    return D

D_detect = H2D(H_detect)
# print(len(D_detect))
# print(min(D_detect),max(D_detect))

# 统计300-1000m的数量
D_detect1 = []
for i in D_detect:
    if i < 1 :
        D_detect1.append(i)

# print(D_detect1)
print(len(D_detect1))


from itertools import groupby
res_det = []
for k, g in groupby(sorted(D_detect1), key=lambda x: x//0.1):
    #print(k,g)
    #print('{}-{}: {}'.format(k*0.05, (k+1)*0.05, len(list(g))))
    res_det.append(len(list(g)))
# 统计300-1000m的数量
D_simulation1 = []
for i in D_simulation:
    if i < 1 :
        D_simulation1.append(i)
print(len(D_simulation1))


# 各个区间的数量统计
res_sim = []
for k, g in groupby(sorted(D_simulation1), key=lambda x: x//0.1):
    #print(k,g)
    #print('{}-{}: {}'.format(k*0.1, (k+1)*0.1, len(list(g))))
    res_sim.append(len(list(g)))
print(res_det)
print(res_sim)

# # 直径分布图
# import matplotlib.pyplot as plt
#
# plt.xlabel('D')
# plt.ylabel('Numbers')
#
# plt.hist(D_detect,weights=[1./len(D_detect)]*len(D_detect),bins=100,density=True,label='Observation')
# #plt.hist(D_simulation,bins=100,weights=[1./len(D_simulation)]*len(D_simulation),label='Simulation')
# plt.xlim(0,1)
# plt.legend(loc='best')
# plt.show()

import matplotlib.pyplot as plt
from matplotlib.ticker import FuncFormatter

x1 = [_ for _ in range(8)]
x2 = [_+0.4 for _ in range(8)]

# 07-21年的观测数据
z1 = [2, 15, 51, 74, 109, 82, 75, 238]




#xuyi 一年的仿真结果统计
z2 = [343, 44, 17, 1, 3, 5, 1,2]


# 1km以上目标数量为基准
z3 = 151
z4 = 2
#实际观测除以观测天数
y1 = [z1[i]/z3 for i in range(len(z1))]
y2 = [z2[i]/z4 for i in range(len(z2))]

# #设置纵坐标为百分比
# def to_percent(temp,pos):
#   return '%1.0f'%(100*temp) + '%'
# plt.gca().yaxis.set_major_formatter(FuncFormatter(to_percent))


name = ['0-0.1','0.1-0.2','0.2-0.3','0.3-0.4','0.4-0.5','0.5-0.6','0.6-0.7','0.7-1']


plt.bar(x1, y1,width=0.4,label='Observation')
plt.bar(x2, y2,width=0.4,tick_label=name,label='Simulation')
#plt.bar(x2, y2,width=0.4,label='Simulation')
plt.xlabel('D(km)')
plt.ylabel('ratio')
# 添加百分比
for x, y in enumerate(y1):
    tmp = str(round(100*y, 2))+'%'
    print(tmp)
    plt.text(x, y+0.15/20,tmp, ha='center')
for x, y in enumerate(y2):
    tmp = str(round(100*y, 2))+'%'
    plt.text(x+0.45, y+0.15/20,tmp, ha='center')
plt.yscale('log')
plt.legend(loc='best')
#plt.savefig('./pic/completionbins1y_g.png')
plt.show()